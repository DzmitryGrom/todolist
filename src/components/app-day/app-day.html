<template id="appDay">
  <style>
    @import "/components/app-day/app-day.css";
    :host {
      position: relative;
      width: 330px;
      flex-shrink: 0;
      display: block;
      margin: 0 15px;
      padding-top: 32px;
      @media (max-width: 360px) {
        width: 100%;
        margin-left: 0;
        margin-right: 0;
      }
    }
  </style>
  <label class="day__label"></label>
  <div class="day__inner">
    <span class="day__btn-add">
      <i class="icon-add">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
              <path fill="#9AA5AB"
                    d="M0.530276514,8.03380613 C0.234829923,8.03380613 0,7.79147055 0,7.49618369 C0,7.20089683 0.234829923,6.96619387 0.530276514,6.96619387 L6.96184809,6.96619387 L6.96184809,0.53762244 C6.96232539,0.242335581 7.20479206,0 7.50023865,0 C7.79568524,0 8.03051516,0.242335581 8.03051516,0.53762244 L8.03051516,6.96619387 L14.4620867,6.96619387 C14.7575333,6.96619387 15,7.20089683 15,7.49618369 C15,7.79147055 14.7575333,8.03380613 14.4620867,8.03380613 L8.03051516,8.03380613 L8.03051516,14.4623776 C8.03051516,14.7576644 7.79568524,15 7.50023865,15 C7.20479206,15 6.96232539,14.7576644 6.96232539,14.4623776 L6.96232539,8.03380613 L0.530276514,8.03380613 Z"
                    transform="translate(5 5)"></path>
          </svg>
      </i>
      <span class="day__btn-add-text">Добавить заметку</span>
    </span>
  </div>
</template>

<script>
  (() => {
    const template = document.currentScript.ownerDocument.querySelector('template');
    appViewDayFactory.$inject = ['app.main.model.view', 'app.main.util.Emitter', 'app.main.component.appNote'];
    Core.module('app.main').component('app.main.component.appDay', appViewDayFactory);
    function appViewDayFactory(viewModel, Emitter) {

      class AppDay extends HTMLElement {
        constructor(data) {

          super();
          const shadowRoot = this.attachShadow({mode: 'open'});
          this.rootElement = template.content.cloneNode(true);
          this.shadowRoot.appendChild(this.rootElement);
          let dayInner = shadowRoot.querySelector('.day__inner'),
              label =  shadowRoot.querySelector('.day__label'),
              elemNote = document.createElement("app-note"),
              element = new Emitter();

          label.innerText = `${data.dayName}, ${data.date}`;


          shadowRoot.addEventListener('click', (event) => {
            let target = event.target;

            if(target.tagName === 'SPAN') {

              dayInner.appendChild(elemNote);
            }

          }, false);

          viewModel.subscribeMainViewName(name => {

            let appNote = shadowRoot.querySelector('app-note');
            //dayInner.childElementCount.remove();
          }, true);

        }
      }
      customElements.define('app-day', AppDay);
      return AppDay;
    }
  })();
</script>